<div class="container">
    <div class="floating-button-container">
        <button [@fadeInFromBottom]="true" class="floating-button" data-bs-toggle="modal"
            data-bs-target="#modalObligacion">
            <div class="icon-container">
                <i class="fa-solid fa-magnifying-glass fa-2x"></i>
            </div><br>
            <div class="text-container">
                <span class="text">Buscar</span> <!-- Nuevo elemento de texto para mostrar en el hover -->
            </div>
        </button>
    </div>
    <div class="card-c">
        <div *ngIf="newGestion.gestion.trim() != '' || newGestion.gestion.trim() != ''" class="row justify-content-end"
            data-bs-target="#offcanvasRight">
            <div class="col-md-4">
                <div class="alert alert-danger text-end" role="alert" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasRight" style="cursor: pointer;"
                    (click)="findCuentaCobrar(newGestion.numeroObligacion)">
                    <h6>Editando Gestion De {{ newGestion.numeroObligacion }}</h6>
                </div>
            </div>
        </div>
        <!-- OCULTAR COLUMNAS -->
        <div class="accordion" id="accordionExample" *ngIf="!spinner">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        Ocultar Columnas
                    </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                    <div class="accordion-body">
                        <div class="row justify-content-center mb-3">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row justify-content-center mb-2">
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input *ngIf="Columnas.length <= 10 || !Columnas.includes('BANCO')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[1])">
                                                    <label class="form-check-label">
                                                        Banco
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('DIAS VENC')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[2])">
                                                    <label class="form-check-label">
                                                        Dias Ven.
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('EDAD VENC')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[3])">
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        Edad Ven.
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('SUCURSAL')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[4])">
                                                    <label class="form-check-label">
                                                        Sucursal
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input *ngIf="Columnas.length <= 10 || !Columnas.includes('ASESOR')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[5])">
                                                    <label class="form-check-label" for="flexCheckDefault">
                                                        Asesor
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row justify-content-center">
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('CLAS JURI')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[6])">
                                                    <label class="form-check-label">
                                                        Clas. Juri
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('SALDO CAP')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[7])">
                                                    <label class="form-check-label">
                                                        Saldo Cap.
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input *ngIf="Columnas.length <= 10 || !Columnas.includes('ANIO')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[8])">
                                                    <label class="form-check-label">
                                                        Año
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('F GESTION')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[9])">
                                                    <label class="form-check-label">
                                                        F. Gestión
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="form-check">
                                                    <input
                                                        *ngIf="Columnas.length <= 10 || !Columnas.includes('F COMPRO')"
                                                        class="form-check-input" type="checkbox"
                                                        (click)="ocultarColumnas(constantes[10])">
                                                    <label class="form-check-label">
                                                        F. Compro.
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row justify-content-center">
            <div class="col-md-12">
                <!-- SIDEBAR -->
                <div class="offcanvas offcanvas-bottom" tabindex="-1" id="offcanvasRight"
                    aria-labelledby="offcanvasRightLabel" style="height: 77%;">
                    <div *ngIf="!spinnerSidebar" class="offcanvas-header">
                        <h5 class="offcanvas-title" id="offcanvasRightLabel">Datos Cliente</h5>
                        <button *ngIf="deshabilitarInputs" class="btn btn-danger b" data-bs-toggle="modal"
                            data-bs-target="#modalGestion">Nueva
                            Gestion</button>
                        <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#modalHistoricoG"
                            (click)="cerrarGestiones()">Historico Gestiones</button>
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <div *ngIf="spinnerSidebar" class="d-flex align-items-center justify-content-center" style="height: 70vh;">
                            <div class="text-center">
                              <div class="spinner-border" role="status" style="width: 5rem; height: 5rem; color: #960010;">
                                <span class="visually-hidden"></span>
                              </div>
                            </div>
                          </div>
                          
                        <div *ngIf="!spinnerSidebar" class="card">
                            <div class="card-header">
                                <h5 class="text-center">Gestor Encargado: {{
                                    cuentaCobrarSelected.asesorCarteraResponse.usuario.nombres }} {{
                                    cuentaCobrarSelected.asesorCarteraResponse.usuario.apellidos }}</h5>
                            </div>
                            <div class="card-body text-center">
                                <div class="card mb-3">
                                    <div class="card-body text-center">
                                        <div class="row text-center">
                                            <div class="col-md-4">
                                                <strong>Nro. Obligación:</strong> {{
                                                cuentaCobrarSelected.numeroObligacion }}
                                            </div>
                                            <div class="col-md-4">
                                                <strong>Nro. Creditos:</strong> {{ cuentaCobrarSelected.numeroCreditos
                                                }}
                                            </div>
                                            <div class="col-md-4">
                                                <strong>Condición Cliente:</strong> {{
                                                cuentaCobrarSelected.condicionEspecial }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- INFO PERSONAL -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Información Personal
                                            </div>
                                            <div class="card-body">
                                                <div class="row justify-content-center">
                                                    <div class="col-md-4">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Cédula</span>
                                                            <input [(ngModel)]="cuentaCobrarSelected.documentoCliente"
                                                                type="text" class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Nombre</span>
                                                            <input type="text" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.clientes[0].nombreTitular"
                                                                disabled>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Lugar/Res</span>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.clientes[0].municipio"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.clientes[0].departamento"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Telefonos</span>
                                                            <select class="form-select"
                                                                (change)="copyToClipboard($event)" id="element"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].telefonos[0].numero">

                                                                <option
                                                                    *ngFor="let t of cuentaCobrarSelected.clientes[0].telefonos">
                                                                    {{ t.numero }}</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row">
                                                    <div class="col-md-8">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Dirección</span>
                                                            <input type="text" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.clientes[0].direcciones[0].direccion"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- CREDITOS -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Información Del Credito
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Vendedor</span>
                                                            <input type="text" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.vendedor" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Clasificación</span>
                                                            <input type="text" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.clasificacion"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Fec/Credito</span>
                                                            <input type="date"
                                                                [(ngModel)]="cuentaCobrarSelected.fechaCuentaCobrar"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Fec/Venc</span>
                                                            <input type="date" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.fechaVencimiento"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="col-md-4">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text"
                                                                id="inputGroup-sizing-default">Monto Inicial</span>
                                                            <input type="text" class="form-control"
                                                                aria-label="Sizing example input"
                                                                aria-describedby="inputGroup-sizing-default" disabled>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- MORA -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCal">
                                                Información De La Mora
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Saldo Capital
                                                                Vencido</span>
                                                            <input (change)="calculadora($event)"
                                                                id="boton_saldo_capital" type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.moraObligatoria"
                                                                class="form-control" [disabled]="deshabilitarInputs">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Saldo Capital
                                                                Total</span>
                                                            <input (change)="calculadora($event)" id="boton_saldo_total"
                                                                type="number"
                                                                [(ngModel)]="cuentaCobrarSelected.clientes[0].saldoActual"
                                                                class="form-control" [disabled]="deshabilitarInputs">
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Interes Mora</span>
                                                            <input [(ngModel)]="acuerdoCal.valorInteresesMora"
                                                                type="text" class="form-control"
                                                                (change)="cambiarIntereses($event)"
                                                                [disabled]="deshabilitarInputs">
                                                        </div>
                                                    </div>
                                                    <div *ngIf="cuentaCobrarSelected.clasificacionJuridica == 'Prejuridico'"
                                                        class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Honorarios</span>
                                                            <input [(ngModel)]="acuerdoCal.honoriarioAcuerdo"
                                                                type="number" class="form-control"
                                                                [disabled]="deshabilitarInputs">
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Saldo Mora
                                                                Total</span>
                                                            <input [(ngModel)]="acuerdoCal.valorTotalMora" type="text"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Saldo Total</span>
                                                            <input [(ngModel)]="acuerdoCal.valorTotalAcuerdo"
                                                                type="number" class="form-control" disabled>
                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Mora/Venc</span>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.tiposVencimiento.tipoVencimiento"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.diasVencidos"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Cuotas</span>
                                                            <input type="text" [(ngModel)]="cuentaCobrarSelected.cuotas"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.cuotas - cuentaCobrarSelected.cuotasMora"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.cuotasMora"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row justify-content-center mt-3">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Fecha Venc</span>
                                                            <input type="date" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.fechaVencimiento"
                                                                (change)="calcularDiasVencidos($event)"
                                                                [disabled]="deshabilitarInputs">
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Sede</span>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.sede.sede"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [(ngModel)]="cuentaCobrarSelected.banco.banco"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="cuentaCobrarSelected.clientes[0].saldoActual <= cuentaCobrarSelected.moraObligatoria"
                                                        class="col-md-8">
                                                        <p class="alert alert-danger mt-3 text-center">CREDITO VENCIDO
                                                            EN SU TOTALIDAD</p>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div *ngIf="!deshabilitarInputs" class="col-md-2">
                                                        <button *ngIf="!resetButton" class="btn btn-danger b"
                                                            (click)="reiniciarCalculadora()"><i
                                                                class="fa-solid fa-xmark"></i></button>
                                                        <button *ngIf="resetButton" type="button"
                                                            class="btn btn-danger b">
                                                            <span class="spinner-border spinner-border-sm float-right"
                                                                role="status" aria-hidden="true"></span>
                                                        </button>
                                                    </div>
                                                    <div *ngIf="!deshabilitarInputs" class="col-md-2">
                                                        <button class="btn btn-success" (click)="confirmarDatos()"><i
                                                                class="fa-solid fa-check"></i></button>
                                                    </div>
                                                    <div *ngIf="deshabilitarInputs" class="col-md-2">
                                                        <button class="btn btn-success" (click)="habilitar()"><i
                                                                class="fa-solid fa-check"></i></button>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- REFERENCIAS -->
                                        <div class="card text-center mb-2">
                                            <div class="card-header text-center tituloCard">
                                                Referencias
                                            </div>
                                            <div class="card-body">
                                                <div class="form-floating">
                                                    <textarea class="form-control"
                                                        [(ngModel)]="cuentaCobrarSelected.clientes[0].descripcionDetallada"
                                                        style="height: 140px" disabled></textarea>
                                                    <label class="fw-bold">Referencia</label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row justify-content-start">
                                            <div class="col-md-12">
                                                <!-- CODEUDORES -->
                                                <div class="card text-center">
                                                    <div class="card-header text-center tituloCard">
                                                        Codeudores
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-md-8">
                                                                <div class="input-group input-group-sm mb-3">
                                                                    <span
                                                                        class="input-group-text fw-bold">Codeudores</span>
                                                                    <select class="form-select"
                                                                        (change)="findCodeudores($event)">
                                                                        <option>Seleccione Un Codeudor</option>
                                                                        <option *ngFor="let co of codeudores"
                                                                            value="{{ co.numeroDocumento }}">{{
                                                                            co.nombreTitular}}</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4">
                                                                <div class="input-group input-group-sm mb-3">
                                                                    <span class="input-group-text fw-bold">Nro.
                                                                        Codeudores</span>
                                                                    <input type="text" class="form-control"
                                                                        [(ngModel)]="codeudores.length" disabled>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <span *ngFor="let cs of codeudoresSelected">
                                                            <div class="row justify-content-center">
                                                                <div class="col-md-12">
                                                                    <div class="input-group input-group-sm mb-3">
                                                                        <span
                                                                            class="input-group-text fw-bold">Dirección</span>
                                                                        <input type="text" class="form-control"
                                                                            value="{{ cs.direcciones[0].direccion }}"
                                                                            disabled>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row justify-content-center">
                                                                <div class="col-md-12">
                                                                    <div class="input-group input-group-sm mb-3">
                                                                        <span
                                                                            class="input-group-text fw-bold">Celular</span>
                                                                        <input type="text" class="form-control"
                                                                            value="{{ cs.telefonos[0].indicativo }} {{ cs.telefonos[0].numero }}"
                                                                            disabled>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="form-floating">
                                                                <textarea class="form-control" style="height: 77px"
                                                                    value="{{ cs.descripcionDetallada }}"
                                                                    disabled></textarea>
                                                                <label class="fw-bold">Referencia</label>
                                                            </div>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="spinner" class="text-center">
                    <div class="spinner-border" role="status" style="width: 5rem; height: 5rem; color: #960010;">
                        <span class="visually-hidden"></span>
                    </div>
                </div>

                <!-- TABLA -->

                <div *ngIf="!spinner" class="table-responsive align-middle">
                    <button class="btn btn-danger b filter" data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasFilter">
                        <h6 class="text-center mt-1" style="font-size: 13px;">Filtros</h6>
                    </button>

                    <table class="table table-responsive table-bordered text-center table-hover">
                        <thead>
                            <tr>
                                <th class="h" *ngIf="!Columnas.includes('CLIENTE')">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Cliente
                                        </div>
                                    </div>
                                </th>
                                <th class="h" *ngIf="!Columnas.includes('BANCO')">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Banco
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('DIAS VENC')">Dias Vencidos</th>
                                <th *ngIf="!Columnas.includes('EDAD VENC')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            E. Vencimiento
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SUCURSAL')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Sucursal
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('ASESOR')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Asesor
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('CLAS JURI')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Clas. Juridica
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SALDO CAP')">Saldo Capital</th>
                                <th *ngIf="!Columnas.includes('ANIO')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Año
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('F GESTION')">F. Gestión</th>
                                <th *ngIf="!Columnas.includes('F COMPRO')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            F. Compromiso
                                        </div>
                                    </div>
                                </th>
                            </tr>

                            <tr *ngIf="isSticky" [ngClass]="{'sticky': isSticky}"
                                class="justify-content-center text-center">
                                <th class="h" *ngIf="!Columnas.includes('CLIENTE')">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Cliente
                                        </div>
                                    </div>
                                </th>
                                <th class="h" *ngIf="!Columnas.includes('BANCO')">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Banco
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('DIAS VENC')">Dias Vencidos</th>
                                <th *ngIf="!Columnas.includes('EDAD VENC')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            E. Vencimiento
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SUCURSAL')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Sucursal
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('ASESOR')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Asesor
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('CLAS JURI')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Clas. Juridica
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SALDO CAP')">Saldo Capital</th>
                                <th *ngIf="!Columnas.includes('ANIO')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            Año
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('F GESTION')">F. Gestión</th>
                                <th *ngIf="!Columnas.includes('F COMPRO')" class="h">
                                    <div class="row justify-content-center">
                                        <div class="col-md-12">
                                            F. Compromiso
                                        </div>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cc of cuentasCobrarArray" class="align-middle" data-bs-toggle="offcanvas"
                                data-bs-target="#offcanvasRight" style="cursor: pointer;"
                                (click)="findCuentaCobrar(cc.numeroObligacion)">
                                <td *ngIf="!Columnas.includes('CLIENTE')">{{ cc.cliente }}</td>
                                <td *ngIf="!Columnas.includes('BANCO')">{{ cc.banco.banco }}</td>
                                <td *ngIf="!Columnas.includes('DIAS VENC')">{{ cc.diasVencidos }}</td>
                                <td *ngIf="!Columnas.includes('EDAD VENC')">{{ cc.tiposVencimiento.tipoVencimiento }}
                                </td>
                                <td *ngIf="!Columnas.includes('SUCURSAL')">{{ cc.sede.sede }}</td>
                                <td *ngIf="!Columnas.includes('ASESOR')">{{ cc.asesorCarteraResponse.usuario.nombres }}
                                    {{
                                    cc.asesorCarteraResponse.usuario.apellidos }}</td>
                                <td *ngIf="!Columnas.includes('CLAS JURI')">{{ cc.clasificacionJuridica }}</td>
                                <td *ngIf="!Columnas.includes('SALDO CAP')">{{ cc.totalObligatoria | number }}</td>
                                <td *ngIf="!Columnas.includes('ANIO')">{{ cc.fechaCuentaCobrar | date:'yyyy' }}</td>
                                <td *ngIf="!Columnas.includes('F GESTION')">{{ cc.gestion.length == 0 ? 'SIN GESTIÓN' :
                                    cc.gestion[cc.gestion.length-1].fechaGestion | date:"d/M/yyyy" }}</td>
                                <td *ngIf="!Columnas.includes('F COMPRO')">{{ cc.gestion.length == 0 ? 'SIN GESTIÓN' :
                                    (cc.gestion[cc.gestion.length-1].clasificacionGestion.nombresClasificacion.tipo ==
                                    'TAREA' ?
                                    (cc.gestion[cc.gestion.length-1].clasificacionGestion.fechaTarea | date:"d/M/yyyy")
                                    :
                                    (cc.gestion[cc.gestion.length-1].clasificacionGestion.nombresClasificacion.tipo ==
                                    'NOTA' ? 'NOTA' :
                                    (cc.gestion[cc.gestion.length-1].clasificacionGestion.fechaCompromiso |
                                    date:"d/M/yyyy")))}}
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </div>
                <nav *ngIf="numeroPages > 1" class="row justify-content-center mt-2">
                    <div *ngIf="!spinner" class="pag">
                        <nav>
                            <ul class="pagination">
                                <li class="page-item">
                                    <a class="page-link b" (click)="back()" style="cursor: pointer;">Anterior</a>
                                </li>

                                <li class="page-item">
                                    <div class="btn-group dropup">
                                        <button type="button" class="page-link dropdown-toggle"
                                            style="cursor: pointer; text-decoration: none; color: white;background-color: #960010;"
                                            data-bs-toggle="dropdown">{{page+1}}/{{numeroPages}}</button>
                                        <ul class="dropdown-menu" style="overflow-y: auto; height: 400px;">
                                            <li *ngFor="let p of paginas;let i = index"><button class="dropdown-item"
                                                    (click)="goToPage(i)">{{i
                                                    + 1}}</button></li>

                                        </ul>
                                    </div>
                                </li>
                                <li class="page-item">
                                    <a class="page-link b" (click)="next()" style="cursor: pointer;">Siguiente</a>
                                </li>
                            </ul>
                            <div class="row text-center justify-content-center">
                                <div class="col-md-6">
                                    <nav class="text-center justify-content-center" style="margin-top: -15px;">
                                        <ul class="pagination pagination-sm">
                                            <li class="page-item">
                                                <a class="page-link b">#Registros: </a>
                                            </li>
                                            <li class="page-item">
                                                <div class="btn-group dropup">
                                                    <button type="button" class="page-link dropdown-toggle"
                                                        style="cursor: pointer; text-decoration: none; color: white;background-color: #960010;"
                                                        data-bs-toggle="dropdown"></button>
                                                    <ul class="dropdown-menu" style="overflow-y: auto; height: 120px;">
                                                        <li><button class="dropdown-item"
                                                                (click)="seleccionarSize(20)">20</button></li>
                                                        <li><button class="dropdown-item"
                                                                (click)="seleccionarSize(50)">50</button></li>
                                                        <li><button class="dropdown-item"
                                                                (click)="seleccionarSize(100)">100</button></li>
                                                    </ul>
                                                </div>
                                            </li>
                                        </ul>

                                    </nav>
                                </div>
                            </div>

                        </nav>
                    </div>
                </nav>
            </div>
        </div>
    </div>

    <!-- Modal Nueva Gestión -->
    <div class="modal fade" id="modalGestion" tabindex="-1" aria-labelledby="modalGestion" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="modalGestion">Nueva Gestión</h1>
                    <button type="button" data-bs-dismiss="modal" aria-label="Close" style="border: none"><i
                            class="fa-solid fa-arrow-left"></i></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col" [ngClass]="{'col-md-12': col, 'col-md-4': !col}">
                            <div class="form-floating mb-3">
                                <textarea class="form-control" style="height: 100px;" [(ngModel)]="newGestion.gestion"
                                    name="gestion"></textarea>
                                <label for="floatingTextarea">Descripcion</label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" [(ngModel)]="newGestion.contact" [checked]="true"
                                    type="checkbox" role="switch" checked>
                                <label class="form-check-label">Existió contacto
                                    Telefónico/Whatsapp con el Cliente y/o Tercero (?)</label>
                            </div>
                            <select class="form-select mt-3 mb-3"
                                [(ngModel)]="newGestion.clasificacion.nombreClasificacion"
                                (change)="tipoClasificacion($event)">
                                <option [value]="null">Seleccione Una Clasificación</option>
                                <option *ngFor="let c of ClasificacionArray" [value]="c.nombre">{{
                                    c.nombre }}</option>
                            </select>

                            <!-- ACUERDO PAGO -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'ACUERDO DE PAGO'">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Fecha Comp</span>
                                            <input type="date" class="form-control"
                                                [(ngModel)]="acuerdo.fechaCompromiso" [max]="maxFecha()"
                                                [min]="minFecha()" [disabled]="disabledFecha">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Valor Cuota</span>
                                            <input type="number" class="form-control"
                                                [(ngModel)]="acuerdo.valorCuotaMensual">
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center mt-3 mb-3">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio"
                                                    [(ngModel)]="acuerdo.tipoAcuerdo" value="MORA">
                                                <label class="form-check-label">
                                                    Mora
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio"
                                                    [(ngModel)]="acuerdo.tipoAcuerdo" value="TOTAL">
                                                <label class="form-check-label">
                                                    Total
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3 mb-3 justify-content-center">
                                    <div class="col-md-2">
                                        <button class="btn btn-danger b" (click)="mostrarOffcanvas()">Calcular</button>
                                    </div>
                                </div>
                            </span>

                            <!-- TAREA -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'TAREA'">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Fecha Fin</span>
                                            <input type="date" class="form-control" [(ngModel)]="tarea.fechaFinTarea"
                                                [min]="minFecha()">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-floating mb-3">
                                    <textarea class="form-control" style="height: 100px;"
                                        [(ngModel)]="tarea.detalleTarea"></textarea>
                                    <label for="floatingTextarea">Detalle Tarea</label>
                                </div>
                            </span>

                            <!-- NOTA -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'NOTA'">
                                <div class="form-floating mb-3">
                                    <textarea class="form-control" style="height: 100px;"
                                        [(ngModel)]="nota.detalle"></textarea>
                                    <label for="floatingTextarea">Detalle Nota</label>
                                </div>
                            </span>
                            <div class="form-floating mb-3">
                                <textarea class="form-control" style="height: 100px;"
                                    [(ngModel)]="newGestion.detallesAdicionales"></textarea>
                                <label for="floatingTextarea">Datos Adicionales</label>
                            </div>
                        </div>
                        <div *ngIf="!col" class="col-md-8">
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Mora/Total</span>
                                        <input [(ngModel)]="acuerdoCal.tipoAcuerdo" type="text" class="form-control"
                                            readonly>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Valor Acuerdo</span>
                                        <input [(ngModel)]="acuerdoCal.valorTotalAcuerdo" type="number"
                                            class="form-control" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Int Mora</span>
                                        <input [(ngModel)]="acuerdoCal.valorInteresesMora" type="number"
                                            class="form-control" readonly>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Valor Cuota Mes</span>
                                        <input [(ngModel)]="acuerdoCal.valorCuotaMensual" type="number"
                                            class="form-control" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Fecha Corte</span>
                                        <input [(ngModel)]="fechaCorte" type="date" class="form-control" readonly>
                                    </div>
                                </div>
                                <div *ngIf="cuentaCobrarSelected.clasificacionJuridica == 'Prejuridico'"
                                    class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Honorarios/Otros</span>
                                        <input [(ngModel)]="acuerdoCal.honoriarioAcuerdo" type="number"
                                            class="form-control" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive align-middle">
                                <table class="table table-bordered text-center table-hover table-sm align-middle">
                                    <thead>
                                        <tr>
                                            <th scope="col">#Cuotas</th>
                                            <th scope="col">Fecha Venc</th>
                                            <th scope="col">Valor Cuota</th>
                                            <th scope="col">Capital Cuota</th>
                                            <th scope="col">Honorarios</th>
                                            <th scope="col">Interes</th>
                                        </tr>
                                    </thead>
                                    <tbody>

                                        <tr *ngFor="let c of cuotas; let i = index;" style="font-size: 15px;">
                                            <td>Cuota {{ i + 1 }}</td>
                                            <td>{{ fechasIncrementadas[i] }}</td>
                                            <td>
                                                <div class="input-group input-group-sm">
                                                    <input type="number" class="form-control text-center"
                                                        value="{{c.valorCuota}}" (change)="recalcularValores(i, $event)"
                                                        [disabled]="disableds[i]">
                                                </div>
                                            </td>
                                            <td>{{ c.capitalCuota | number }}</td>
                                            <td>{{ c.honorarios | number }}</td>
                                            <td>{{ c.interesCuota | number }}</td>
                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" (click)="cancelarGestion()">Limpiar</button>
                    <button type="button" class="btn btn-secondary" data-bs-toggle="modal"
                        data-bs-target="#modalHistoricoG" (click)="abrirGestiones()">Histórico Gestiones</button>
                    <button *ngIf="!gestionButton" type="button" class="btn btn-danger b"
                        (click)="saveGestion()">Guardar</button>
                    <button *ngIf="gestionButton" class="btn btn-danger b">
                        Guardando...
                        <span class="spinner-border spinner-border-sm float-right" role="status"
                            aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Historico Gestiones -->
    <div class="modal fade" id="modalHistoricoG" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Histórico Gestiones</h1>
                    <button *ngIf="!modalGestiones" type="button" class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                    <button *ngIf="modalGestiones" type="button" class="btn-close" data-bs-toggle="modal"
                        data-bs-target="#modalGestion"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive align-middle">
                        <table class="table table-bordered text-center table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Gestor</th>
                                    <th scope="col">Fecha Gestión</th>
                                    <th scope="col">Clasificación</th>
                                    <th scope="col">Detalle Gestión</th>
                                    <th scope="col">Estado</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let g of gestiones; let i = index" (click)="getOneGestion(g.idGestion)"
                                    data-bs-toggle="modal" data-bs-target="#modalGestionCom" style="cursor: pointer;">
                                    <th>{{ i + 1 }}</th>
                                    <td>{{ g.asesorCartera }}</td>
                                    <td>{{ g.fechaGestion | date:'dd/MM/yyyy' }} {{ g.fechaGestion | date:'shortTime' }}
                                    </td>
                                    <td>{{ g.clasificacion.clasificacion }}</td>
                                    <td>{{ g.detallesGestion }}</td>
                                    <td>{{ g.clasificacion.isActive ? 'Activo':g.clasificacion.nombresClasificacion.tipo
                                        != "ACUERDO DE PAGO"?'Sin Estado':'No Activo' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button *ngIf="!modalGestiones" type="button" class="btn btn-secondary"
                        data-bs-dismiss="modal">Cerrar</button>
                    <button *ngIf="modalGestiones" type="button" class="btn btn-secondary" data-bs-toggle="modal"
                        data-bs-target="#modalGestion">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalle Gestión -->
    <div class="modal fade" id="modalDetalle" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Agregar Un Detalle A la Gestión</h1>
                </div>
                <div class="modal-body">
                    <div class="form-floating mb-3">
                        <input type="email" class="form-control" [(ngModel)]="acuerdo.detalle" style="height: 100px;">
                        <label for="floatingInput">¿Desea Agregar Un Detalle?</label>
                    </div>
                    <h6>Seleccione El Cliente Al Que Desea Agregar El Acuerdo</h6>
                    <select class="form-select mt-3 mb-3" [(ngModel)]="reporte.cedula" (change)="cambiarCedula($event)">
                        <option [value]="null">Seleccione Una Cedula</option>
                        <option *ngFor="let c of cuentaCobrarSelected.clientes" [value]="c.numeroDocumento">{{
                            c.numeroDocumento }} - {{ c.nombreTitular }} - {{ c.tipoGarante.tipoGarante }}</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" (click)="saveGestionWithDetalle('NO')">GUARDAR SIN DETALLE</button>
                    <button class="btn btn-primary" (click)="saveGestionWithDetalle('SI')">GUARDAR CON DETALLE</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ver Reporte -->
    <div class="modal fade" id="modalReporte" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Ver Reporte de Acuerdo de Pago</h1>
                </div>
                <div class="modal-body">
                    <h4>¿Desea Enviar El Reporte Al Cliente?</h4>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
                    <a [href]="mensaje" target="_blank"><button class="btn btn-primary" (click)="mostrarBase64()"
                            data-bs-dismiss="modal">Enviar</button></a>
                    <a [href]="'data:application/pdf;base64,' + base64" id="base64" style="display: none;"
                        [download]="clienteSelected.numeroDocumento + ' - ' + clienteSelected.nombreTitular"></a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Gestion Completa -->
    <div class="modal fade" id="modalGestionCom" tabindex="-1" data-bs-show="true" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Gestión Seleccionada</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" *ngIf="gestionSelected != null">
                    <!-- PARTE ACUERDO DE PAGO-->
                    <span *ngIf="gestionSelected.clasificacion.clasificacion == 'ACUERDO DE PAGO'">
                        <div class="row m-3">
                            <div class="row">
                                <div class="col-md-6 ">

                                    <h6><strong>Saldo Intreses Acuerdo: </strong> {{saldoInteresesAcuerdo | number}}
                                    </h6>
                                    <h6><strong>Saldo Honorario Acuerdo: </strong> {{saldoHonoriariosAcuerdo | number}}
                                    </h6>
                                    <h6><strong>Saldo Capital Acuerdo: </strong> {{saldoCapitalAcuerdo | number}}</h6>
                                    <h6><strong>Pagos Realizados: </strong> <a data-bs-toggle="modal"
                                            href="#exampleModalToggle" role="button" class="btn btn-danger btn-sm"
                                            style="background-color: #960010;border-color: #960010;"><i
                                                class="fas fa-eye"></i></a>
                                    </h6>
                                </div>
                                <div class="col-md-6">
                                    <h6><strong>Valor Total Acuerdo: </strong>
                                        {{gestionSelected.clasificacion.valorTotalAcuerdo | number}}</h6>
                                    <h6><strong>Fecha Acuerdo: </strong>
                                        {{gestionSelected.clasificacion.fechaAcuerdo |
                                        date:'dd/MM/yyyy'}}</h6>
                                    <h6><strong>Saldo Actual Acuerdo: </strong> {{saldoAcuerdoPago | number}}</h6>
                                    <h6><strong>Agregar Pago: </strong> <a role="button" class="btn btn-danger btn-sm"
                                            (click)="mostrarAgregarPago=true"
                                            style="background-color: #960010;border-color: #960010;"><i
                                                class="fas fa-plus"></i></a>
                                    </h6>
                                </div>
                            </div>
                            <div class="col-md-12 " *ngIf="mostrarAgregarPago">


                                <form action="">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <label for="">Valor del Pago</label>
                                            <input type="text" [(ngModel)]="pago.valor" class="form-control"
                                                name="valor">

                                        </div>
                                        <div class="col-md-4">
                                            <label for="">Numero Recibo</label>
                                            <input type="text" [(ngModel)]="pago.recibo" class="form-control"
                                                name="recibo">
                                        </div>
                                        <div class="col-md-4">
                                            <label for="">Detalle</label>
                                            <textarea name="detalle" [(ngModel)]="pago.detalle" class="form-control"
                                                id="" cols="30" rows="1"></textarea>
                                        </div>
                                        <div class="row mt-2">
                                            <div class="col-md-4 offset-md-4">
                                                <button class="btn btn-primary"
                                                    (click)="agregarPagoACuotas()" style="background-color: #960010;border-color: #960010;">Agregar Pago</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>

                            </div>

                        </div>

                        <div class="table-responsive align-middle">
                            <table class="table table-bordered text-center table-hover table-sm align-middle">
                                <thead>
                                    <tr>
                                        <th scope="col">Cuota</th>
                                        <th scope="col">Fecha Venc</th>
                                        <th scope="col">Valor Cuota</th>
                                        <th scope="col">Capital Cuota</th>
                                        <th scope="col">Honorarios</th>
                                        <th scope="col">Interes</th>
                                        <th scope="col">Pago</th>
                                    </tr>
                                </thead>
                                <tbody *ngIf="gestionSelected != null">

                                    <tr *ngFor="let g of cuotasList">
                                        <td>{{ g.numeroCuota }}</td>
                                        <td>{{ g.fechaVencimiento | date:'dd/MM/yyyy' }}</td>
                                        <td>{{ g.valorCuota | number }}</td>
                                        <td>{{ g.capitalCuota | number }}</td>
                                        <td>{{ g.honorarios | number }}</td>
                                        <td>{{ g.interesCuota | number }}</td>
                                        <td class="justify-content-center">
                                            <div class="row justify-content-center">
                                                <div class="col-md-6">
                                                    <div class="form-check text-center">
                                                        <input cli class="form-check-input" type="checkbox"
                                                            [checked]="g.cumplio==true" [disabled]="g.cumplio==true">
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>

                                </tbody>
                            </table>
                        </div>
                    </span>
                    <!-- TAREA -->
                    <div class="card" *ngIf="gestionSelected.clasificacion.clasificacion == 'TAREA'">
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <div class="col-md-12 mb-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="gestionSelected.detallesGestion" class="form-control"
                                            readonly></textarea>
                                        <label for="floatingTextarea">Descripción</label>
                                    </div>

                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text fw-bold">Fecha Tarea</span>
                                        <input type="text" class="form-control"
                                            [value]="gestionSelected.clasificacion.fechaFinTarea | date:'dd/MM/yyyy'"
                                            readonly>

                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text fw-bold">Detalle Tarea</span>
                                        <input type="text" class="form-control"
                                            [(ngModel)]="gestionSelected.clasificacion.detalleTarea" readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-12 mb-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="gestionSelected.detallesAdicionales" class="form-control"
                                            readonly></textarea>
                                        <label for="floatingTextarea">Detalles Adicionales</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- NOTA -->
                    <div class="card" *ngIf="gestionSelected.clasificacion.clasificacion == 'NOTA'">
                        <div class="card-body">
                            <div class="row justify-content-center">
                                <div class="col-md-12 mb-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="gestionSelected.detallesGestion" class="form-control"
                                            readonly></textarea>
                                        <label for="floatingTextarea">Descripción</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-12 mb-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="gestionSelected.clasificacion.detalleNota"
                                            class="form-control" readonly></textarea>
                                        <label for="floatingTextarea">Detalle Nota</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-12">
                                    <div class="input-group mb-3">
                                        <span class="input-group-text fw-bold">Fecha Nota</span>
                                        <input type="text" class="form-control"
                                            [value]="gestionSelected.clasificacion.fechaNota | date:'dd/MM/yyyy'"
                                            readonly>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-12 mb-3">
                                    <div class="form-floating">
                                        <textarea [(ngModel)]="gestionSelected.detallesAdicionales" class="form-control"
                                            readonly></textarea>
                                        <label for="floatingTextarea">Detalles Adicionales</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" (click)="modalGestionSelected()">Cerrar</button>

                    <!-- BOTONES ACUERDO DE PAGO -->
                    <span *ngIf="gestionSelected != null || gestionSelected != undefined">
                        <button
                            *ngIf="gestionSelected.clasificacion.clasificacion == 'ACUERDO DE PAGO' && gestionSelected.clasificacion.isActive == true"
                            type="button" class="btn btn-danger b" (click)="desactivarAcuerdo()">Desactivar</button>
                    </span>

                    <span *ngIf="gestionSelected != null || gestionSelected != undefined">

                        <button
                            *ngIf="gestionSelected.clasificacion.clasificacion == 'ACUERDO DE PAGO' && gestionSelected.clasificacion.isActive == true"
                            type="button" class="btn btn-danger b" (click)="generarRecibo()" data-bs-dismiss="modal">Aplicar Pagos</button>

                    </span>

                    <!-- BOTONES TAREA -->
                    <span *ngIf="gestionSelected != null || gestionSelected != undefined">
                        <button *ngIf="gestionSelected.clasificacion.clasificacion == 'TAREA'" type="button"
                            class="btn btn-danger b">Desactivar</button>
                    </span>
                </div>
            </div>
        </div>
    </div>

    <!-- FILTROS -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasFilter" style="width: 20%; border-radius: 7px;">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Filtros</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="row mb-3">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Bancos</h6>
                                </blockquote>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="COL"
                                        (click)="metodoBancos('COL')">
                                    <label class="form-check-label">
                                        <cite title="Source Title">COL</cite>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="POP"
                                        (click)="metodoBancos('POP')">
                                    <label class="form-check-label">
                                        <cite title="Source Title">POP</cite>
                                    </label>
                                </div>
                            </figure>
                        </div>
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Dias Vencidos</h6>
                                </blockquote>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text fw-bold">Desde/Hasta</span>
                                    <input type="number" [(ngModel)]="filtros.diasVencidosInicio" class="form-control">
                                    <input type="number" [(ngModel)]="filtros.diasVencidosFin" class="form-control">
                                </div>
                            </figure>
                        </div>
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Edad Vencimiento</h6>
                                </blockquote>
                                <div class="form-check" *ngFor="let t of tiposVen; let i = index">
                                    <input value="{{ t.tipoVencimiento }}" class="form-check-input" type="checkbox"
                                        (click)="metodoEdadVen(t.tipoVencimiento)">
                                    <label class="form-check-label">
                                        <cite title="Source Title">{{ t.tipoVencimiento}}</cite>
                                    </label>
                                </div>
                            </figure>
                        </div>
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Sedes</h6>
                                </blockquote>
                                <div class="form-check" *ngFor="let s of sedes; let i = index">
                                    <input value="{{ s.sede }}" class="form-check-input" type="checkbox"
                                        (click)="metodoSede(s.sede)">
                                    <label class="form-check-label">
                                        <cite title="Source Title">{{ s.sede }}</cite>
                                    </label>
                                </div>
                            </figure>
                        </div>
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Clasificación Jurídica</h6>
                                </blockquote>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Normal"
                                        (click)="metodoClas('Normal')">
                                    <label class="form-check-label">
                                        <cite title="Source Title">Normal</cite>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Prejuridico"
                                        (click)="metodoClas('Prejuridico')">
                                    <label class="form-check-label">
                                        <cite title="Source Title">Prejuridico</cite>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="Juridico"
                                        (click)="metodoClas('Juridico')">
                                    <label class="form-check-label">
                                        <cite title="Source Title">Juridico</cite>
                                    </label>
                                </div>
                            </figure>
                        </div>
                        <figure>
                            <blockquote class="blockquote">
                                <h6 class="fw-bold">Saldo</h6>
                            </blockquote>
                            <div class="input-group input-group-sm">
                                <span class="input-group-text fw-bold">Desde/Hasta</span>
                                <input type="number" [(ngModel)]="filtros.saldoCapitalInicio" class="form-control">
                                <input type="number" [(ngModel)]="filtros.saldoCapitalFin" class="form-control">
                            </div>
                        </figure>

                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Año</h6>
                                </blockquote>
                                <select (change)="calcularFechasAnio($event)" class="form-select">
                                    <option [value]="null" selected>Seleccione Un Año</option>
                                    <option *ngFor="let a of listaDeAnios" [value]="a">{{ a }}</option>
                                </select>
                            </figure>

                        </div>
                        <div class="col-md-12 mb-3">
                            <figure>
                                <blockquote class="blockquote">
                                    <h6 class="fw-bold">Fecha Gestión</h6>
                                </blockquote>
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text fw-bold">Desde/Hasta</span>
                                    <input type="date" [(ngModel)]="filtros.fechaGestionInicio" class="form-control">
                                    <input type="date" [(ngModel)]="filtros.fechaGestionFin" class="form-control">
                                </div>
                            </figure>
                        </div>
                        <div class="col-md-12 mb-3">
                            <div class="col-md-12 mb-3">
                                <figure>
                                    <blockquote class="blockquote">
                                        <h6 class="fw-bold">Fecha Compromiso</h6>
                                    </blockquote>
                                    <div class="input-group input-group-sm">
                                        <span class="input-group-text fw-bold">Desde/Hasta</span>
                                        <input type="date" [(ngModel)]="filtros.fechaCompromisoInicio"
                                            class="form-control">
                                        <input type="date" [(ngModel)]="filtros.fechaCompromisoFin"
                                            class="form-control">
                                    </div>
                                </figure>
                            </div>
                        </div>
                        <div class="row justify-content-center">
                            <div class="col-md-4">
                                <button *ngIf="!botonFiltro" class="btn btn-danger b"
                                    (click)="filtro()">Filtrar</button>
                                <button *ngIf="botonFiltro" class="btn btn-danger b">
                                    Filtrando...
                                    <span class="spinner-border spinner-border-sm float-right" role="status"
                                        aria-hidden="true"></span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- MODAL BUSCAR OBLIGACION -->
    <div class="modal fade" id="modalObligacion" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Buscar Obligación</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <span class="input-group-text fw-bold">Dato</span>
                        <input [(ngModel)]="buscarObligacion" type="text" class="form-control">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button *ngIf="!botonFiltrarObligacion" type="button" class="btn btn-danger b"
                        (click)="getByDato()">Buscar</button>
                    <button *ngIf="botonFiltrarObligacion" class="btn btn-danger b">
                        Filtrando...
                        <span class="spinner-border spinner-border-sm float-right" role="status"
                            aria-hidden="true"></span>
                    </button>
                </div>

            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="exampleModalToggle" aria-hidden="true" aria-labelledby="exampleModalToggleLabel"
    tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalToggleLabel">Pagos</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="table responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Numero Recibo</th>
                                <th>Fecha Recibo</th>
                                <th>Valor</th>
                                <th>Pdf</th>
                            </tr>
                        </thead>
                        <tbody>

                            <tr *ngFor="let recibo of recibosPago;let i = index;">

                                <td>{{i+1}}</td>
                                <td>{{recibo.numeroRecibo}}</td>
                                <td>{{recibo.fechaRecibo | date:'dd/MM/yyyy'}}</td>
                                <td>{{recibo.valorRecibo | number}}</td>
                                <td><button class="btn btn-primary" (click)="obtenerReciboPosition(i)"
                                        class="btn btn-danger btn-sm"
                                        style="background-color: #960010;border-color: #960010;"
                                        data-bs-target="#exampleModalToggle2" data-bs-toggle="modal"
                                        data-bs-dismiss="modal"><i class="fas fa-eye"></i></button>


                            </tr>


                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2"
    tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalToggleLabel2">Recibo</h5>
                <button type="button" class="btn-close" data-bs-target="#exampleModalToggle" data-bs-toggle="modal"
                    data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <embed id="mostrarRecibo" src="" height="500px" width="465px" type="application/pdf">


            </div>

        </div>
    </div>

</div>


<div class="modal fade" id="reciboPago" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalToggleLabel2">Recibo de Pago</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <embed id="mostrarReciboPago" src="" height="500px" width="465px" type="application/pdf">

            </div>

        </div>
    </div>

</div>
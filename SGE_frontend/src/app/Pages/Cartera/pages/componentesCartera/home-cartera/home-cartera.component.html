<div class="container">
    <div class="card-c">
        <div *ngIf="newGestion.gestion.trim() != '' || newGestion.gestion.trim() != ''" class="row justify-content-end">
            <div class="col-md-4">
                <div class="alert alert-danger text-end" role="alert">
                    <h6>Editando Gestion De {{ newGestion.numeroObligacion }}</h6>
                  </div>
            </div>
        </div>
        <!-- OCULTAR COLUMNAS -->
        <div class="accordion" id="accordionExample" *ngIf="!spinner">
            <div class="accordion-item">
              <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                  Ocultar Columnas
                </button>
              </h2>
              <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                    <div class="row justify-content-center mb-3">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-body">
                                    <div class="row justify-content-center mb-2">
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('BANCO')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[1])">
                                                <label class="form-check-label">
                                                  Banco
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('DIAS VENC')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[2])">
                                                <label class="form-check-label">
                                                  Dias Ven.
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('EDAD VENC')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[3])">
                                                <label class="form-check-label" for="flexCheckDefault">
                                                  Edad Ven.
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('SUCURSAL')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[4])">
                                                <label class="form-check-label">
                                                  Sucursal
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('ASESOR')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[5])">
                                                <label class="form-check-label" for="flexCheckDefault">
                                                  Asesor
                                                </label>
                                              </div>
                                        </div>
                                    </div>
                                    <div class="row justify-content-center">
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('CLAS JURI')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[6])">
                                                <label class="form-check-label">
                                                  Clas. Juri
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('SALDO CAP')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[7])">
                                                <label class="form-check-label">
                                                  Saldo Cap.
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('ANIO')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[8])">
                                                <label class="form-check-label">
                                                  Año
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('F GESTION')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[9])">
                                                <label class="form-check-label">
                                                  F. Gestión
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-check">
                                                <input *ngIf="Columnas.length <= 10 || !Columnas.includes('F COMPRO')" class="form-check-input" type="checkbox" (click)="ocultarColumnas(constantes[10])">
                                                <label class="form-check-label">
                                                  F. Compro.
                                                </label>
                                              </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-12">
                <!-- SIDEBAR -->
                <div class="offcanvas offcanvas-bottom" tabindex="-1" id="offcanvasRight"
                    aria-labelledby="offcanvasRightLabel" style="height: 77%;">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title" id="offcanvasRightLabel">Datos Cliente</h5>
                        <button class="btn btn-danger b" data-bs-toggle="modal" data-bs-target="#modalGestion">Nueva
                            Gestion</button>
                        <button class="btn btn-secondary" data-bs-toggle="modal"
                            data-bs-target="#modalHistoricoG" (click)="cerrarGestiones()">Historico Gestiones</button>
                        <!-- <button class="btn btn-secondary" data-bs-toggle="modal"
                            data-bs-target="#modalHistoricoA">Historico Abonos</button> -->
                        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <div *ngIf="spinnerSidebar" class="text-center align-middle">
                            <div class="spinner-border" role="status"
                                style="width: 5rem; height: 5rem; color: #960010;">
                                <span class="visually-hidden"></span>
                            </div>
                        </div>
                        <div *ngIf="!spinnerSidebar" class="card">
                            <div class="card-header">
                                <h5 class="text-center">Gestor Encargado: {{
                                    cuentaCobrarSelected.asesorCarteraResponse.usuario.nombres }} {{
                                    cuentaCobrarSelected.asesorCarteraResponse.usuario.apellidos }}</h5>
                            </div>
                            <div class="card-body text-center">
                                <div class="card mb-3">
                                    <div class="card-body text-center">
                                        <div class="row text-center">
                                            <div class="col-md-4">
                                                <strong>Nro. Obligación:</strong> {{
                                                cuentaCobrarSelected.numeroObligacion }}
                                            </div>
                                            <div class="col-md-4">
                                                <strong>Nro. Creditos:</strong> {{ cuentaCobrarSelected.numeroCreditos
                                                }}
                                            </div>
                                            <div class="col-md-4">
                                                <strong>Condición Cliente:</strong> {{
                                                cuentaCobrarSelected.condicionEspecial }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- INFO PERSONAL -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Información Personal
                                            </div>
                                            <div class="card-body">
                                                <div class="row justify-content-center">
                                                    <div class="col-md-4">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Cédula</span>
                                                            <input [ngModel]="cuentaCobrarSelected.documentoCliente"
                                                                type="text" class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Nombre</span>
                                                            <input type="text" class="form-control"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].nombreTitular"
                                                                disabled>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Lugar/Res</span>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].municipio"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].departamento"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Telefonos</span>
                                                            <select class="form-select"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].telefonos[0].numero">
                                                                <option
                                                                    *ngFor="let t of cuentaCobrarSelected.clientes[0].telefonos">
                                                                    {{ t.numero }}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-8">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Dirección</span>
                                                            <input type="text" class="form-control"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].direcciones[0].direccion"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- CREDITOS -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Información Del Credito
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Vendedor</span>
                                                            <input type="text" class="form-control"
                                                                [ngModel]="cuentaCobrarSelected.vendedor" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Clasificación</span>
                                                            <input type="text" class="form-control"
                                                                [ngModel]="cuentaCobrarSelected.clasificacion" disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Fec/Credito</span>
                                                            <input type="date"
                                                                [ngModel]="cuentaCobrarSelected.fechaCuentaCobrar"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Fec/Venc</span>
                                                            <input type="date" class="form-control"
                                                                [ngModel]="cuentaCobrarSelected.fechaVencimiento"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="col-md-4">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text"
                                                                id="inputGroup-sizing-default">Monto Inicial</span>
                                                            <input type="text" class="form-control"
                                                                aria-label="Sizing example input"
                                                                aria-describedby="inputGroup-sizing-default" disabled>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <!-- MORA -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Información De La Mora
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">S.Total</span>
                                                            <input type="number"
                                                                [ngModel]="cuentaCobrarSelected.clientes[0].saldoActual"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">S.Mora</span>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.moraObligatoria"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Mora/Venc</span>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.edadVencimiento"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.diasVencidos"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Cuotas</span>
                                                            <input type="text" [ngModel]="cuentaCobrarSelected.cuotas"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.cuotas - cuentaCobrarSelected.cuotasMora"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.cuotasMora"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>

                                                </div>
                                                <div class="row justify-content-center mt-3">
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Fecha Venc</span>
                                                            <input type="date" class="form-control"
                                                                [(ngModel)]="cuentaCobrarSelected.fechaVencimiento"
                                                                disabled>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="input-group input-group-sm">
                                                            <span class="input-group-text fw-bold">Sede</span>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.sede.sede"
                                                                class="form-control" disabled>
                                                            <input type="text"
                                                                [ngModel]="cuentaCobrarSelected.banco.banco"
                                                                class="form-control" disabled>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="cuentaCobrarSelected.clientes[0].saldoActual <= cuentaCobrarSelected.moraObligatoria"
                                                        class="col-md-8">
                                                        <p class="alert alert-danger mt-3 text-center">CREDITO VENCIDO
                                                            EN SU TOTALIDAD</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <!-- REFERENCIAS -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Referencias
                                            </div>
                                            <div class="card-body">
                                                <div class="form-floating">
                                                    <textarea class="form-control"
                                                        [ngModel]="cuentaCobrarSelected.clientes[0].descripcionDetallada"
                                                        style="height: 140px" disabled></textarea>
                                                    <label class="fw-bold">Referencia</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-start">
                                    <div class="col-md-6">
                                        <!-- CODEUDORES -->
                                        <div class="card text-center">
                                            <div class="card-header text-center tituloCard">
                                                Codeudores
                                            </div>
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-md-8">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Codeudores</span>
                                                                <select class="form-select" (change)="findCodeudores($event)">
                                                                <option >Seleccione Un Codeudor</option>
                                                                <option *ngFor="let co of codeudores" value="{{ co.numeroDocumento }}" >{{ co.nombreTitular}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="input-group input-group-sm mb-3">
                                                            <span class="input-group-text fw-bold">Nro. Codeudores</span>
                                                            <input type="text" class="form-control"
                                                                [(ngModel)]="codeudores.length" disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span *ngFor="let cs of codeudoresSelected">
                                                    <div class="row justify-content-center">
                                                        <div class="col-md-12">
                                                            <div class="input-group input-group-sm mb-3">
                                                                <span class="input-group-text fw-bold">Dirección</span>
                                                                <input type="text" class="form-control"
                                                                value="{{ cs.direcciones[0].direccion }}"
                                                                disabled>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row justify-content-center">
                                                        <div class="col-md-12">
                                                            <div class="input-group input-group-sm mb-3">
                                                                <span class="input-group-text fw-bold">Celular</span>
                                                                <input type="text" class="form-control"
                                                                value="{{ cs.telefonos[0].indicativo }} {{ cs.telefonos[0].numero }}"
                                                                disabled>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-floating">
                                                        <textarea class="form-control" style="height: 77px"
                                                        value="{{ cs.descripcionDetallada }}"
                                                        disabled></textarea>
                                                        <label class="fw-bold">Referencia</label>
                                                    </div>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="spinner" class="text-center">
                    <div class="spinner-border" role="status" style="width: 5rem; height: 5rem; color: #960010;">
                        <span class="visually-hidden"></span>
                    </div>
                </div>
                
                <div *ngIf="!spinner" class="table-responsive align-middle">
                    <table class="table table-responsive table-bordered text-center table-hover">
                        <thead>
                            <tr>
                                <th class="h" *ngIf="!Columnas.includes('CLIENTE')">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-6">
                                            Cliente
                                        </div>
                                        <div class="col-md-6">
                                            <i class="fa-solid fa-caret-down"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th class="h" *ngIf="!Columnas.includes('BANCO')">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Banco
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('DIAS VENC')">Dias Vencidos</th>
                                <th *ngIf="!Columnas.includes('EDAD VENC')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            E. Vencimiento
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SUCURSAL')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Sucursal
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('ASESOR')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Asesor
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('CLAS JURI')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Clas. Juridica
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SALDO CAP')">Saldo Capital</th>
                                <th *ngIf="!Columnas.includes('ANIO')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-6">
                                            Año
                                        </div>
                                        <div class="col-md-6">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('F GESTION')">F. Gestión</th>
                                <th *ngIf="!Columnas.includes('F COMPRO')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            F. Compromiso
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                            </tr>

                            <tr *ngIf="isSticky" [ngClass]="{'sticky': isSticky}" class="justify-content-center text-center">
                                <th class="h" *ngIf="!Columnas.includes('CLIENTE')">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-6">
                                            Cliente
                                        </div>
                                        <div class="col-md-6">
                                            <i class="fa-solid fa-caret-down"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th class="h" *ngIf="!Columnas.includes('BANCO')">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Banco
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('DIAS VENC')">Dias Vencidos</th>
                                <th *ngIf="!Columnas.includes('EDAD VENC')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            E. Vencimiento
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SUCURSAL')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Sucursal
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('ASESOR')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Asesor
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('CLAS JURI')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            Clas. Juridica
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('SALDO CAP')">Saldo Capital</th>
                                <th *ngIf="!Columnas.includes('ANIO')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-6">
                                            Año
                                        </div>
                                        <div class="col-md-6">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                                <th *ngIf="!Columnas.includes('F GESTION')">F. Gestión</th>
                                <th *ngIf="!Columnas.includes('F COMPRO')" class="h">
                                    <div class="row justify-content-center" type="button" data-bs-toggle="dropdown">
                                        <div class="col-md-8">
                                            F. Compromiso
                                        </div>
                                        <div class="col-md-4">
                                            <i class="fa-solid fa-caret-down" type="button"
                                                data-bs-toggle="dropdown"></i>
                                            <div class="dropdown-menu">
                                                <select class="form-select" aria-label="Default select example">
                                                    <option selected>Open this select menu</option>
                                                    <option value="1">One</option>
                                                    <option value="2">Two</option>
                                                    <option value="3">Three</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let cc of cuentasCobrarArray" class="align-middle" data-bs-toggle="offcanvas"
                                data-bs-target="#offcanvasRight" style="cursor: pointer;"
                                (click)="findCuentaCobrar(cc.numeroObligacion)">
                                <td *ngIf="!Columnas.includes('CLIENTE')">{{ cc.cliente }}</td>
                                <td *ngIf="!Columnas.includes('BANCO')">{{ cc.banco.banco }}</td>
                                <td *ngIf="!Columnas.includes('DIAS VENC')">{{ cc.diasVencidos }}</td>
                                <td *ngIf="!Columnas.includes('EDAD VENC')">{{ cc.edadVencimiento }}</td>
                                <td *ngIf="!Columnas.includes('SUCURSAL')">{{ cc.sede.sede }}</td>
                                <td *ngIf="!Columnas.includes('ASESOR')">{{ cc.asesorCarteraResponse.usuario.nombres }} {{
                                    cc.asesorCarteraResponse.usuario.apellidos }}</td>
                                <td *ngIf="!Columnas.includes('CLAS JURI')">{{ cc.clasificacionJuridica }}</td>
                                <td *ngIf="!Columnas.includes('SALDO CAP')">{{ cc.clientes[0].saldoActual }}</td>
                                <td *ngIf="!Columnas.includes('ANIO')">2000</td>
                                <td *ngIf="!Columnas.includes('F GESTION')">25/05/2023</td>
                                <td *ngIf="!Columnas.includes('F COMPRO')">25/05/2023</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <nav *ngIf="numeroPages > 1" class="row justify-content-center mt-2">
                        <div *ngIf="!spinner" class="pag">
                                <nav>
                                    <ul class="pagination">
                                        <li class="page-item">
                                            <a class="page-link b" (click)="back()"
                                                style="cursor: pointer;">Anterior</a>
                                        </li>

                                        <li class="page-item">
                                            <div class="btn-group dropup">
                                                <button type="button" class="page-link dropdown-toggle"
                                                    style="cursor: pointer; text-decoration: none; color: white;background-color: #960010;"
                                                    data-bs-toggle="dropdown">{{page+1}}/{{numeroPages}}</button>
                                                <ul class="dropdown-menu"  style="overflow-y: auto; height: 400px;">
                                                    <li *ngFor="let p of paginas;let i = index"><button
                                                            class="dropdown-item" (click)="goToPage(i)">{{i
                                                            + 1}}</button></li>

                                                </ul>
                                            </div>
                                        </li>
                                        <li class="page-item">
                                            <a class="page-link b" (click)="next()"
                                                style="cursor: pointer;">Siguiente</a>
                                        </li>
                                    </ul>
                                    <div class="row text-center justify-content-center">
                                        <div class="col-md-6">
                                            <nav class="text-center justify-content-center" style="margin-top: -15px;">
                                                <ul class="pagination pagination-sm">
                                                    <li class="page-item">
                                                        <a class="page-link b">#Registros: </a>
                                                    </li>
                                                    <li class="page-item">
                                                        <div class="btn-group dropup">
                                                            <button type="button" class="page-link dropdown-toggle"
                                                                style="cursor: pointer; text-decoration: none; color: white;background-color: #960010;"
                                                                data-bs-toggle="dropdown"></button>
                                                            <ul class="dropdown-menu" style="overflow-y: auto; height: 120px;">
                                                                <li><button class="dropdown-item" (click)="seleccionarSize(20)">20</button></li>
                                                                <li><button class="dropdown-item" (click)="seleccionarSize(50)">50</button></li>
                                                                <li><button class="dropdown-item" (click)="seleccionarSize(100)">100</button></li>
                                                            </ul>
                                                        </div>
                                                    </li>
                                                </ul>
                                                
                                            </nav>
                                        </div>
                                    </div>
                                    
                                </nav>
                        </div>
                    </nav>
            </div>
        </div>
    </div>

    <!-- Modal Nueva Gestión -->
    <div class="modal fade" id="modalGestion" tabindex="-1" aria-labelledby="modalGestion" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="modalGestion">Nueva Gestión</h1>
                    <button type="button" data-bs-dismiss="modal" aria-label="Close" style="border: none"><i class="fa-solid fa-arrow-left"></i></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col" [ngClass]="{'col-md-12': col, 'col-md-4': !col}">
                            <div class="form-floating mb-3">
                                <textarea class="form-control" style="height: 100px;" [(ngModel)]="newGestion.gestion" name="gestion"></textarea>
                                <label for="floatingTextarea">Descripcion</label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" [(ngModel)]="newGestion.contact" [checked]="true" type="checkbox" role="switch" checked>
                                <label class="form-check-label">Existió contacto
                                    Telefónico/Whatsapp con el Cliente y/o Tercero (?)</label>
                            </div>
                            <select class="form-select mt-3 mb-3" [(ngModel)]="newGestion.clasificacion.tipoClasificacion">
                                <option [value]="null">Seleccione Una Clasificación</option>
                                <option *ngFor="let c of ClasificacionArray" [value]="c.clasificacion">{{ c.clasificacion }}</option>
                            </select>
        
                            <!-- ACUERDO PAGO -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'Acuerdo de Pago'">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Fecha Comp</span>
                                            <input type="date" class="form-control" [(ngModel)]="acuerdo.fechaCompromiso" [max]="maxFecha()" [min]="minFecha()">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Valor Cuota</span>
                                            <input type="number" class="form-control" [(ngModel)]="acuerdo.valorCuotaMensual">
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center mt-3 mb-3">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" [(ngModel)]="acuerdo.tipoAcuerdo" value="MORA">
                                                <label class="form-check-label">
                                                  Mora
                                                </label>
                                              </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" [(ngModel)]="acuerdo.tipoAcuerdo" value="TOTAL">
                                                <label class="form-check-label">
                                                  Total
                                                </label>
                                              </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3 mb-3 justify-content-center">
                                    <div class="col-md-2">
                                        <button class="btn btn-danger b" (click)="mostrarOffcanvas()">Calcular</button>
                                    </div>
                                </div>
                            </span>
        
                            <!-- TAREA -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'Tarea'">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="input-group input-group-sm mb-3">
                                            <span class="input-group-text fw-bold">Fecha Fin</span>
                                            <input type="date" class="form-control" [(ngModel)]="tarea.fechaFinTarea" [min]="minFecha()">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <select class="form-select mb-3" [(ngModel)]="tarea.clasificacion">
                                            <option [value]="null">Seleccione Una Clasificación</option>
                                            <option *ngFor="let c of clasificacionesT">{{ c.clasificacionTarea }}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-floating mb-3">
                                    <textarea class="form-control" style="height: 100px;" [(ngModel)]="tarea.detalleTarea"></textarea>
                                    <label for="floatingTextarea">Detalle Tarea</label>
                                </div>
                            </span>
        
                            <!-- NOTA -->
                            <span *ngIf="newGestion.clasificacion.tipoClasificacion == 'Nota'">
                                <div class="form-floating mb-3">
                                    <textarea class="form-control" style="height: 100px;" [(ngModel)]="nota.detalle"></textarea>
                                    <label for="floatingTextarea">Detalle Nota</label>
                                </div>
                            </span>
                            <div class="form-floating mb-3">
                                <textarea class="form-control" style="height: 100px;" [(ngModel)]="newGestion.detallesAdicionales"></textarea>
                                <label for="floatingTextarea">Datos Adicionales</label>
                            </div>
                        </div>
                        <div *ngIf="!col" class="col-md-8">
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Mora/Total</span>
                                        <input type="text" class="form-control" value="TOTAL" disabled>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Valor Acuerdo</span>
                                        <input type="number" class="form-control" value="" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Int Mora</span>
                                        <input type="number" class="form-control" value="TOTAL" disabled>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Valor Cuota Mes</span>
                                        <input type="number" class="form-control" value="9999" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="row justify-content-center">
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Fecha Corte</span>
                                        <input type="number" class="form-control" value="2023/12/07" disabled>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group input-group-sm mb-3">
                                        <span class="input-group-text fw-bold">Honorarios/Otros</span>
                                        <input type="number" class="form-control" value="99999" disabled>
                                    </div>
                                </div>
                            </div>
                            <div class="table-responsive align-middle">
                                <table class="table table-responsive table-bordered text-center table-hover">
                                    <thead>
                                      <tr>
                                        <th scope="col">#Cuotas</th>
                                        <th scope="col">Fecha Venc</th>
                                        <th scope="col">Valor Cuota</th>
                                        <th scope="col">Capital Cuota</th>
                                        <th scope="col">Honorarios</th>
                                        <th scope="col">Interes</th>
                                        <th scope="col">Cumplio</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr>
                                        <th>Cuota 1</th>
                                      </tr>
                                    </tbody>
                                  </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" (click)="cancelarGestion()">Limpiar</button>
                    <button type="button" class="btn btn-secondary" data-bs-toggle="modal"
                    data-bs-target="#modalHistoricoG" (click)="abrirGestiones()">Histórico Gestiones</button>
                    <button *ngIf="!gestionButton" type="button" class="btn btn-danger b" (click)="saveGestion()">Guardar</button>
                    <button *ngIf="gestionButton" class="btn btn-danger b">
                        Guardando...
                        <span class="spinner-border spinner-border-sm float-right" role="status" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

<!-- Modal Historico Gestiones -->
    <div class="modal fade" id="modalHistoricoG" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Histórico Gestiones</h1>
                    <button *ngIf="!modalGestiones" type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    <button *ngIf="modalGestiones" type="button" class="btn-close" data-bs-toggle="modal"
                    data-bs-target="#modalGestion"></button>
                </div>
                <div class="modal-body">
                    <div class="table-responsive align-middle">
                        <table class="table table-bordered text-center table-hover">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Gestor</th>
                                    <th scope="col">Fecha Gestión</th>
                                    <th scope="col">Clasificación</th>
                                    <th scope="col">Detalle Gestión</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let g of gestiones; let i = index">
                                    <th>{{ i + 1 }}</th>
                                    <td>{{ g.asesorCartera }}</td>
                                    <td>{{ g.fechaGestion | date:'medium' }}</td>
                                    <td>{{ g.clasificacion.clasificacion }}</td>
                                    <td>{{ g.detallesGestion }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="modal-footer">
                    <button *ngIf="!modalGestiones" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <button *ngIf="modalGestiones" type="button" class="btn btn-secondary" data-bs-toggle="modal"
                    data-bs-target="#modalGestion">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Offcanvas Confirmar Datos -->
    <div *ngIf="newGestion.clasificacion.tipoClasificacion == 'Acuerdo de Pago'" class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="offcanvasTop" aria-labelledby="offcanvasTopLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasTopLabel">Confirmar Datos</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" (click)="mostrarModalGestion()"></button>
    </div>
    <div class="offcanvas-body">
        <div class="row justify-content-center">
            <div class="col-md-12 mb-3">
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text fw-bold">Valor Total</span>
                    <input type="number" class="form-control" [(ngModel)]="cuentaCobrarSelected.totalObligatoria">
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-12 mb-3">
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text fw-bold">Mora Obligatoria</span>
                    <input type="number" class="form-control" [(ngModel)]="cuentaCobrarSelected.moraObligatoria">
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-12 mb-3">
                <div class="input-group input-group-sm mb-3">
                    <span class="input-group-text fw-bold">Fecha Venc</span>
                    <input type="date" class="form-control" [(ngModel)]="cuentaCobrarSelected.fechaVencimiento">
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-4">
                <button class="btn btn-danger b" (click)="mostrarModalGestion()"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="col-md-2">
                <button class="btn btn-success" (click)="calcular()"><i class="fa-solid fa-check"></i></button>
            </div>
        </div>
    </div>
    </div>